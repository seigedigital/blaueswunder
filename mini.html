<!DOCTYPE html>
<html>
<head>
<title>AR.js A-Frame Location-based</title>
<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
<script type='text/javascript' src='https://raw.githack.com/AR-js-org/AR.js/master/three.js/build/ar-threex-location-only.js'></script>
<script type='text/javascript' src='https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js'></script>
</head>
<body>
<a-scene vr-mode-ui='enabled: false' arjs='sourceType: webcam; videoTexture: true; debugUIEnabled: false' renderer='logarithmicDepthBuffer: true; colorManagement: true; sortObjects: true; antialias: true; alpha: true'>

    <a-camera gps-new-camera='gpsMinDistance: 0; gpsMaxDistance: 100000;' camera="near: 0.01; far: 100000;"></a-camera>

    <!--
    <a-entity
        material='color: blue'
        geometry='primitive: box'
        gps-new-entity-place="latitude: 51.32992092551733; longitude: 12.370474432017557"
        scale="1 1 1"
        animation="property: scale; to: 100 100 100; dur: 1000; dir: alternate; loop: true"
    ></a-entity>
    -->
    
    <a-entity
        id="ar-object"
        gltf-model="test-unified.glb"
        gps-new-entity-place="latitude: 51.32992092551733; longitude: 12.370474432017557"
        position="0 -100 0"
        material="side: double"
        scale="100 100 100"
    ></a-entity>

    <!--
    <a-entity
        gltf-model="assets/bridge.glb"
        gps-new-entity-place="latitude: 51.32992092551733; longitude: 12.370474432017557"
        position="0 -100 0"
        material="side: double"
        scale=".1 .1 .1"
        animation="property: scale; to: 200 200 200; dur: 3000; dir: alternate; loop: true"
    ></a-entity>
    -->
    
</a-scene>

<script>
  AFRAME.registerComponent('rotation-reader', {
    init: function () {
      const object = document.querySelector('#ar-object');
      object.object3D.rotation.set(0, THREE.Math.degToRad(90), 0); // Example fixed rotation

      // Adjust for initial camera orientation offset if necessary
      const camera = document.querySelector('[gps-camera]');
      camera.addEventListener('componentchanged', function (evt) {
        if (evt.detail.name === 'rotation') {
          const initialRotation = evt.detail.newData;
          object.object3D.rotation.set(
            THREE.Math.degToRad(0 - initialRotation.x),
            THREE.Math.degToRad(90 - initialRotation.y),
            THREE.Math.degToRad(0 - initialRotation.z)
          );
        }
      });
    }
  });
</script>
    
</body>
</html>
